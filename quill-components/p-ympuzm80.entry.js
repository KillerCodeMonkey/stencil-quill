import{r as t,c as e,h as i,g as s}from"./p-1eca0859.js";class l{constructor(i){t(this,i),this.format="html",this.debug="warn",this.placeholder="Insert text here ...",this.strict=!0,this.styles="{}",this.customToolbarPosition="top",this.preserveWhitespace=!1,this.defaultModules={toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[].slice()},{background:[].slice()}],[{font:[].slice()}],[{align:[].slice()}],["clean"],["link","image","video"]]},this.onInitialised=e(this,"onInitialised",7),this.onContentChanged=e(this,"onContentChanged",7),this.onSelectionChanged=e(this,"onSelectionChanged",7),this.onFocus=e(this,"onFocus",7),this.onBlur=e(this,"onBlur",7)}setEditorContent(t){if("html"===this.format){const e=this.quillEditor.clipboard.convert(t);this.quillEditor.setContents(e,"api")}else if("text"===this.format)this.quillEditor.setText(t);else if("json"===this.format)try{this.quillEditor.setContents(JSON.parse(t),"api")}catch(e){this.quillEditor.setText(t,"api")}else this.quillEditor.setText(t,"api")}getEditorContent(){const t=this.quillEditor.getText(),e=this.quillEditor.getContents();let i=this.editorElement.children[0].innerHTML;if("<p><br></p>"!==i&&"<div><br><div>"!==i||(i=""),"html"===this.format)return i;if("text"===this.format)this.quillEditor.getText();else{if("json"!==this.format)return t;try{return JSON.stringify(e)}catch(e){return t}}}componentDidLoad(){let t=this.modules?JSON.parse(this.modules):this.defaultModules;const e=this.wrapperElement.querySelector('[slot="quill-toolbar"]');if(e&&(t.toolbar=e),this.quillEditor=new Quill(this.editorElement,{debug:this.debug,modules:t,placeholder:this.placeholder,readOnly:this.readOnly||!1,theme:this.theme||"snow",formats:this.formats,bounds:this.bounds?"self"===this.bounds?this.editorElement:this.bounds:document.body,strict:this.strict,scrollingContainer:this.scrollingContainer}),this.styles){const t=JSON.parse(this.styles);Object.keys(t).forEach(e=>{this.editorElement.style.setProperty(e,t[e])})}this.content&&(this.setEditorContent(this.content),this.quillEditor.history.clear()),this.onInitialised.emit(this.quillEditor),this.selectionChangeEvent=this.quillEditor.on("selection-change",(t,e,i)=>{null===t?this.onBlur.emit({editor:this.quillEditor,source:i}):null===e&&this.onFocus.emit({editor:this.quillEditor,source:i}),this.onSelectionChanged.emit({editor:this.quillEditor,range:t,oldRange:e,source:i})}),this.textChangeEvent=this.quillEditor.on("text-change",(t,e,i)=>{const s=this.quillEditor.getText(),l=this.quillEditor.getContents();let o=this.editorElement.querySelector(".ql-editor").innerHTML;"<p><br></p>"!==o&&"<div><br><div>"!==o||(o=null),this.onContentChanged.emit({editor:this.quillEditor,content:l,delta:t,html:o,oldDelta:e,source:i,text:s})})}componentDidUnload(){this.selectionChangeEvent&&this.selectionChangeEvent.removeListener("selection-change"),this.textChangeEvent&&this.textChangeEvent.removeListener("text-change")}updateContent(t){const e=this.getEditorContent();if(["text","html","json"].indexOf(this.format)>-1&&t===e)return null;{let i=!1;try{const s=JSON.stringify(t);i=JSON.stringify(e)!==s}catch(t){return null}if(!i)return null}this.setEditorContent(t)}updateReadOnly(t,e){this.quillEditor&&t!==e&&this.quillEditor.enable(!t)}updatePlaceholder(t,e){this.quillEditor&&t!==e&&(this.quillEditor.root.dataset.placeholder=t)}updateStyle(t,e){if(this.editorElement){if(e){const t=JSON.parse(e);Object.keys(t).forEach(t=>{this.editorElement.style.setProperty(t,"")})}if(t){const e=JSON.parse(t);Object.keys(e).forEach(t=>{this.editorElement.style.setProperty(t,e[t])})}}}render(){const t=i(this.preserveWhitespace?"pre":"div",{"quill-element":!0,ref:t=>this.editorElement=t}),e=[i("slot",{name:"quill-toolbar"})];return"bottom"===this.customToolbarPosition?e.unshift(t):e.push(t),e}get wrapperElement(){return s(this)}static get watchers(){return{content:["updateContent"],readOnly:["updateReadOnly"],placeholder:["updatePlaceholder"],styles:["updateStyle"]}}}class o{constructor(e){t(this,e),this.theme="snow",this.themeClass="ql-snow"}updateTheme(t){this.themeClass=`ql-${t||"snow"}`}render(){return i("div",{class:`ql-container ${this.themeClass} quill-view-html`},i("div",{class:"ql-editor",innerHTML:this.content}))}static get watchers(){return{theme:["updateTheme"]}}static get style(){return".ql-container.quill-view-html.sc-quill-view-html{border:0}"}}export{l as quill_editor,o as quill_view_html};